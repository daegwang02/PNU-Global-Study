<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PNU Global Study</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        * { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }
        body { background: #ffffff; color: #000000; }
        .card-hover { transition: all 0.2s ease; border: 1px solid #e5e5e5; }
        .card-hover:hover { border-color: #000000; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .badge { display:inline-block; padding:4px 12px; font-size:12px; font-weight:500; border-radius:2px; }
        .badge-trade{ background:#000; color:#fff; }
        .badge-econ{ background:#000; color:#fff; }
        .badge-politics{ background:#000; color:#fff; }
        .badge-contest{ background:#f5f5f5; color:#000; border:1px solid #e5e5e5; }
        .badge-job{ background:#f5f5f5; color:#000; border:1px solid #e5e5e5; }
        .btn-filter{ transition:all 0.2s ease; border:1px solid #e5e5e5; background:#fff; }
        .btn-filter:hover{ border-color:#000; }
        .btn-filter.active{ background:#000; color:#fff; border-color:#000; }
        .search-input{ border:1px solid #e5e5e5; transition:border-color 0.2s ease; }
        .search-input:focus{ outline:none; border-color:#000; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [activeTab, setActiveTab] = useState('all');
            const [searchTerm, setSearchTerm] = useState('');
            const [data, setData] = useState({ items: [] });
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                fetch('data.json')
                    .then(res => res.json())
                    .then(json => { setData(json); setLoading(false); })
                    .catch(err => { console.error('데이터 로드 실패:', err); setLoading(false); });
            }, []);

            const jobs = data.items.filter(i => i.type === "채용");
            const contests = data.items.filter(i => i.type === "공모전");
            const allItems = [...jobs, ...contests].sort(
                (a,b) => new Date(b.deadline || 0) - new Date(a.deadline || 0)
            );

            const filteredItems = allItems.filter(item => {
                const matchesTab = activeTab === 'all' ||
                    (activeTab === 'jobs' && item.type === '채용') ||
                    (activeTab === 'contests' && item.type === '공모전') ||
                    (activeTab === 'trade' && item.category === '무역') ||
                    (activeTab === 'econ' && item.category === '경제') ||
                    (activeTab === 'politics' && item.category === '정치외교');

                const matchesSearch = (item.title || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
                    ((item.company || item.organizer || '').toLowerCase().includes(searchTerm.toLowerCase()));

                return matchesTab && matchesSearch;
            });

            const getDaysLeft = (deadline) => {
                if(!deadline) return '-';
                const diff = new Date(deadline) - new Date();
                return Math.ceil(diff / (1000*60*60*24));
            };

            const getCategoryBadgeClass = (cat) => {
                switch(cat){ case '무역': return 'badge-trade'; case '경제': return 'badge-econ'; case '정치외교': return 'badge-politics'; default: return 'badge-job'; }
            };
            const getTypeBadgeClass = (type) => type === '채용' ? 'badge-job' : 'badge-contest';

            return (
                <div className="min-h-screen bg-white">
                    <header className="border-b border-gray-200">
                        <div className="max-w-6xl mx-auto px-6 py-8 flex items-end justify-between">
                            <div>
                                <h1 className="text-4xl font-bold mb-2">PNU Global Study</h1>
                                <p className="text-gray-600 text-sm">Trade · Economics · Politics & Diplomacy</p>
                            </div>
                            <div className="text-right text-xs text-gray-500">
                                Last updated<br/>{new Date().toLocaleDateString()}
                            </div>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto px-6 py-12">
                        <div className="grid grid-cols-3 gap-6 mb-12">
                            <div className="text-center"><div className="text-3xl font-bold mb-1">{jobs.length}</div><div className="text-sm text-gray-600">Jobs</div></div>
                            <div className="text-center"><div className="text-3xl font-bold mb-1">{contests.length}</div><div className="text-sm text-gray-600">Contests</div></div>
                            <div className="text-center"><div className="text-3xl font-bold mb-1">{allItems.filter(i=>i.new).length}</div><div className="text-sm text-gray-600">New</div></div>
                        </div>

                        <div className="mb-8">
                            <input type="text" placeholder="Search..." className="w-full px-4 py-3 search-input text-sm" value={searchTerm} onChange={e=>setSearchTerm(e.target.value)} />
                        </div>

                        <div className="flex flex-wrap gap-2 mb-12">
                            <button onClick={()=>setActiveTab('all')} className={`btn-filter px-4 py-2 text-sm ${activeTab==='all'?'active':''}`}>All</button>
                            <button onClick={()=>setActiveTab('jobs')} className={`btn-filter px-4 py-2 text-sm ${activeTab==='jobs'?'active':''}`}>Jobs</button>
                            <button onClick={()=>setActiveTab('contests')} className={`btn-filter px-4 py-2 text-sm ${activeTab==='contests'?'active':''}`}>Contests</button>
                            <div className="w-px bg-gray-200 mx-1"></div>
                            <button onClick={()=>setActiveTab('trade')} className={`btn-filter px-4 py-2 text-sm ${activeTab==='trade'?'active':''}`}>Trade</button>
                            <button onClick={()=>setActiveTab('econ')} className={`btn-filter px-4 py-2 text-sm ${activeTab==='econ'?'active':''}`}>Economics</button>
                            <button onClick={()=>setActiveTab('politics')} className={`btn-filter px-4 py-2 text-sm ${activeTab==='politics'?'active':''}`}>Politics</button>
                        </div>

                        <div className="space-y-3">
                            {loading ? <div className="text-center py-20 text-gray-400">Loading...</div> :
                             filteredItems.length===0 ? <div className="text-center py-20 text-gray-400">No results found</div> :
                             filteredItems.map(item=>{
                                const daysLeft=getDaysLeft(item.deadline);
                                const isUrgent = typeof daysLeft==='number' && daysLeft <=7;
                                return (
                                    <div key={item.id || item.title} className="card-hover p-6 cursor-pointer bg-white" onClick={()=>window.open(item.url,'_blank')}>
                                        <div className="flex items-start justify-between">
                                            <div className="flex-1">
                                                <div className="flex items-center gap-2 mb-3">
                                                    {item.new && <span className="text-xs font-medium">NEW</span>}
                                                    <span className={`badge ${getTypeBadgeClass(item.type)}`}>{item.type}</span>
                                                    {item.category && <span className={`badge ${getCategoryBadgeClass(item.category)}`}>{item.category}</span>}
                                                </div>
                                                <h3 className="text-lg font-semibold mb-2">{item.title}</h3>
                                                <div className="text-sm text-gray-600 mb-3">{item.company || item.organizer || ''}</div>
                                            </div>
                                            <div className="text-right ml-6">
                                                <div className={`text-sm font-medium mb-1 ${isUrgent?'text-black':'text-gray-600'}`}>D-{daysLeft}</div>
                                                <div className="text-xs text-gray-400">{item.deadline || '-'}</div>
                                            </div>
                                        </div>
                                    </div>
                                );
                             })
                            }
                        </div>
                    </main>

                    <footer className="border-t border-gray-200 mt-20">
                        <div className="max-w-6xl mx-auto px-6 py-8 text-center text-xs text-gray-500">
                            <div className="mb-2">© 2025 Pusan National University</div>
                            <div>School of Global Studies</div>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
